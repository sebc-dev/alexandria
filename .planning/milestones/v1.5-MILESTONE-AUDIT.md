---
milestone: v1.5
audited: 2026-02-20T16:00:00Z
status: tech_debt
scores:
  requirements: 41/42
  phases: 9/10
  integration: 6/6
  flows: 6/6
gaps:
  requirements:
    - id: "CRWL-07"
      status: "deferred"
      phase: "Phase 7"
      claimed_by_plans: ["07-04-PLAN.md"]
      completed_by_plans: []
      verification_status: "deferred"
      evidence: "Explicit scope decision: interval-based scheduling deferred to manual recrawl_source MCP tool. Documented in 07-VERIFICATION.md. REQUIREMENTS.md marks as 'Deferred (manual recrawl_source)'."
    - id: "MCP-05"
      status: "superseded"
      phase: "Phase 5 / Phase 9"
      claimed_by_plans: ["05-01-PLAN.md", "09-02-PLAN.md"]
      completed_by_plans: ["05-02-SUMMARY.md"]
      verification_status: "passed (original), superseded by SRC-05"
      evidence: "MCP-05 required max 6 tools. Phase 9 adds index_statistics (7th tool) to satisfy SRC-05. Documented in 09-VERIFICATION.md as intentional expansion."
  integration: []
  flows: []
tech_debt:
  - phase: 00-ci-quality-gate
    items:
      - "No VERIFICATION.md exists (no requirements mapped — informational only)"
  - phase: 01-foundation-infrastructure
    items:
      - "INFRA-04 (14 GB RAM budget) needs Docker runtime verification — cannot measure without running stack"
      - "Integration tests need Docker runtime confirmation (SmokeIntegrationTest, EmbeddingStoreIT)"
  - phase: 04.5-code-quality-consolidation
    items:
      - "Full ./quality.sh all --with-integration needs Docker runtime for integration test suite"
      - "MarkdownChunker.chunk() at 40 lines (plan target was 25, phase goal says ~30)"
  - phase: 04-ingestion-pipeline
    items:
      - "PreChunkedImporter implemented and tested but NOT exposed via MCP tool — CHUNK-07 feature inaccessible from Claude Code"
  - phase: 07-crawl-operations
    items:
      - "Source.llmsTxtUrl stored in DB but silently ignored by PageDiscoveryService during crawl (auto-detection at standard paths proceeds instead)"
      - "CRWL-07 interval scheduling deferred to manual recrawl_source"
  - phase: 09-source-management-completion
    items:
      - "Source.chunkCount column stores page count (not chunk count); display correctly uses real DB count query — DB column is semantically incorrect"
      - "updateSourceIdBatch is best-effort after embeddingStore.addAll() — failure-window orphans possible if DB connection drops mid-batch"
      - "SRC-04 staleness indicator narrowed to ISO date only (no qualitative 'stale'/'fresh' label)"
---

# Milestone v1.5 — Audit Report

**Audited:** 2026-02-20T16:00:00Z
**Status:** tech_debt — All requirements met. No critical blockers. Accumulated tech debt needs review.

## Executive Summary

Alexandria v1.5 delivers a fully functional self-hosted RAG system. All 10 phases completed. All 6 E2E flows verified. 41/42 requirements satisfied (1 deferred by design). 9 tech debt items across 6 phases.

## Phase Verification Summary

| Phase | Status | Score | Requirements |
|-------|--------|-------|--------------|
| 0. CI & Quality Gate | No VERIFICATION.md | — | None mapped |
| 1. Foundation & Infrastructure | human_needed | 6/6 | INFRA-01 ✓, INFRA-02 ✓, INFRA-04 ?, CHUNK-04 ✓ |
| 2. Core Search | passed | 9/9 | SRCH-01..03 ✓, SRCH-05 ✓, SRCH-06 ✓ |
| 3. Web Crawling | passed | 5/5 | CRWL-01..02 ✓, CRWL-04..05 ✓, CRWL-08 ✓ |
| 4. Ingestion Pipeline | passed | 14/14 | CHUNK-01..03 ✓, CHUNK-05 ✓, CHUNK-07 ✓ |
| 4.5. Code Quality | human_needed | 4/5 | None mapped |
| 5. MCP Server | passed | 9/9 | MCP-01..05 ✓, INFRA-03 ✓ |
| 7. Crawl Operations | passed | 17/17 | CRWL-03 ✓, CRWL-06 ✓, CRWL-07 deferred, CRWL-09..11 ✓ |
| 8. Advanced Search & Quality | passed | 20/20 | CHUNK-06 ✓, SRCH-04 ✓, SRCH-07..10 ✓ |
| 9. Source Management Completion | passed | 9/9 | SRC-01..05 ✓ |

## Requirements Coverage (3-Source Cross-Reference)

### Source: VERIFICATION.md + REQUIREMENTS.md Traceability

SUMMARY.md frontmatter `requirements-completed` not available (none populated).

| REQ-ID | Description | Phase | VERIFICATION Status | REQUIREMENTS Status | Final Status |
|--------|-------------|-------|---------------------|---------------------|--------------|
| SRC-01 | add_source MCP tool | 9 | passed | `[ ]` Pending | **satisfied** (update checkbox) |
| SRC-02 | list_sources with chunk count | 9 | passed | `[ ]` Pending | **satisfied** (update checkbox) |
| SRC-03 | remove_source cascade delete | 9 | passed | `[ ]` Pending | **satisfied** (update checkbox) |
| SRC-04 | Freshness/staleness indicator | 9 | passed (narrowed) | `[ ]` Pending | **satisfied** (update checkbox) |
| SRC-05 | index_statistics MCP tool | 9 | passed | `[ ]` Pending | **satisfied** (update checkbox) |
| CRWL-01 | Recursive crawl from root URL | 3 | passed | `[x]` Complete | **satisfied** |
| CRWL-02 | HTML→Markdown preserving structure | 3 | passed | `[x]` Complete | **satisfied** |
| CRWL-03 | Crawl scope controls | 7 | passed | `[x]` Complete | **satisfied** |
| CRWL-04 | JavaScript-rendered pages | 3 | passed | `[x]` Complete | **satisfied** |
| CRWL-05 | Boilerplate removal | 3 | passed | `[x]` Complete | **satisfied** |
| CRWL-06 | Incremental/delta crawls | 7 | passed | `[x]` Complete | **satisfied** |
| CRWL-07 | Periodic recrawls (scheduled) | 7 | deferred | Deferred | **deferred** (manual recrawl) |
| CRWL-08 | Sitemap.xml discovery | 3 | passed | `[x]` Complete | **satisfied** |
| CRWL-09 | Crawl progress via MCP | 7 | passed | `[x]` Complete | **satisfied** |
| CRWL-10 | Manual recrawl via MCP | 7 | passed | `[x]` Complete | **satisfied** |
| CRWL-11 | llms.txt/llms-full.txt ingestion | 7 | passed | `[x]` Complete | **satisfied** |
| CHUNK-01 | Heading-boundary chunking | 4 | passed | `[x]` Complete | **satisfied** |
| CHUNK-02 | Chunk overlap | 4 | overridden (user) | `[x]` Complete | **satisfied** (user override) |
| CHUNK-03 | Chunk metadata | 4 | passed | `[x]` Complete | **satisfied** |
| CHUNK-04 | ONNX embeddings | 1 | passed | `[x]` Complete | **satisfied** |
| CHUNK-05 | Code extraction | 4 | passed | `[x]` Complete | **satisfied** |
| CHUNK-06 | Version tagging per source | 8 | passed | `[x]` Complete | **satisfied** |
| CHUNK-07 | Pre-chunked import | 4 | passed | `[x]` Complete | **satisfied** (not MCP-exposed) |
| SRCH-01 | Semantic vector search | 2 | passed | `[x]` Complete | **satisfied** |
| SRCH-02 | Keyword FTS search | 2 | passed | `[x]` Complete | **satisfied** |
| SRCH-03 | Hybrid RRF fusion | 2 | passed | `[x]` Complete | **satisfied** |
| SRCH-04 | Filter by source name | 8 | passed | `[x]` Complete | **satisfied** |
| SRCH-05 | Citation metadata | 2 | passed | `[x]` Complete | **satisfied** |
| SRCH-06 | Configurable result count | 2 | passed | `[x]` Complete | **satisfied** |
| SRCH-07 | Cross-encoder reranking | 8 | passed | `[x]` Complete | **satisfied** |
| SRCH-08 | Filter by section path | 8 | passed | `[x]` Complete | **satisfied** |
| SRCH-09 | Filter by version | 8 | passed | `[x]` Complete | **satisfied** |
| SRCH-10 | Filter by content type | 8 | passed | `[x]` Complete | **satisfied** |
| MCP-01 | stdio transport | 5 | passed | `[x]` Complete | **satisfied** |
| MCP-02 | Front-loaded tool descriptions | 5 | passed | `[x]` Complete | **satisfied** |
| MCP-03 | Structured error messages | 5 | passed | `[x]` Complete | **satisfied** |
| MCP-04 | Token budget | 5 | passed | `[x]` Complete | **satisfied** |
| MCP-05 | Max 6 tools | 5 | passed → superseded | `[x]` Complete | **superseded** (now 7 tools) |
| INFRA-01 | docker compose up | 1 | passed | `[x]` Complete | **satisfied** |
| INFRA-02 | Sensible defaults | 1 | passed | `[x]` Complete | **satisfied** |
| INFRA-03 | .mcp.json integration guide | 5 | passed | `[x]` Complete | **satisfied** |
| INFRA-04 | 14 GB RAM budget | 1 | human_needed | `[x]` Complete | **satisfied** (needs runtime check) |

**Totals:** 41 satisfied, 1 deferred (CRWL-07), 0 unsatisfied, 0 orphaned.

## Integration Check Results

**All 6 E2E flows verified COMPLETE:**

1. **add_source → crawl → chunk → embed → search** — Full pipeline wired from MCP tool through Crawl4AI sidecar, MarkdownChunker AST splitting, ONNX embedding, pgvector HNSW storage, hybrid search with cross-encoder reranking.

2. **recrawl_source (incremental)** — Scope filtering via UrlScopeFilter, content hashing via ContentHasher SHA-256, delta ingestion skipping unchanged pages, orphaned page cleanup.

3. **remove_source → cascade delete** — Cancels active crawl, counts chunks for feedback, deleteById with ON DELETE CASCADE (functional since Phase 9 source_id FK fix).

4. **search with filters** — MCP searchDocs → SearchRequest → SearchService.buildFilter() → LangChain4j Filter (source_name, version, section_path, content_type) → EmbeddingStore → RerankerService.

5. **version/source_name metadata flow** — From addSource/recrawlSource → Source entity → CrawlService → IngestionService → DocumentChunkData.toMetadata() → search filter matching.

6. **MCP stdio transport** — 7 @Tool methods registered via MethodToolCallbackProvider, stdio profile activates non-web mode, .mcp.json configures Claude Code connection.

### Integration Findings (Non-Blocking)

| Finding | Severity | Affected Reqs | Impact |
|---------|----------|---------------|--------|
| PreChunkedImporter not exposed via MCP tool | Low | CHUNK-07 | Feature works internally but inaccessible from Claude Code |
| Source.llmsTxtUrl stored but ignored by PageDiscoveryService | Low | None tracked | Manual llms.txt URL override is silently non-functional |
| Source.chunkCount stores page count not chunk count | Info | SRC-02 | DB column semantically incorrect; display uses correct real-time query |

## Tech Debt Summary

**9 items across 6 phases:**

| Phase | Items | Severity |
|-------|-------|----------|
| Phase 0 | Missing VERIFICATION.md (no requirements) | Info |
| Phase 1 | INFRA-04 needs Docker runtime check (2 items) | Low |
| Phase 4 | PreChunkedImporter not MCP-exposed | Low |
| Phase 4.5 | Integration test suite needs Docker; chunk() method 40 lines | Low |
| Phase 7 | Source.llmsTxtUrl silently ignored; CRWL-07 deferred | Low |
| Phase 9 | Source.chunkCount stale; updateSourceIdBatch best-effort; SRC-04 narrowed scope | Low / Info |

---

*Audited: 2026-02-20T16:00:00Z*
*Auditor: Claude (gsd audit-milestone)*
